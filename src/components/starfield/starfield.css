/**
 * Starfield Background Styles
 *
 * Cinematic layered deep space background with:
 * - Nebula fog layer (animated gradients)
 * - Multiple particle layers (stars + dust)
 * - Shooting star streaks
 * - Dystopian signal overlay (scanlines, grain, vignette)
 * - Subtle parallax on mouse movement
 */

/* ================================
   Main Container
   ================================ */

.starfield-container {
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  overflow: hidden;

  /* Base background gradient */
  background: linear-gradient(180deg,
    #050510 0%,
    #0a0a1a 30%,
    #0d0d20 70%,
    #080815 100%
  );

  /* CSS variables for parallax effect */
  --parallax-x: 0px;
  --parallax-y: 0px;
}

/* ================================
   Layer 1: Nebula Fog
   ================================ */

.starfield-nebula {
  position: absolute;
  inset: 0;
  opacity: 0.35;
  pointer-events: none;
  z-index: 0;

  /* Multiple radial gradients for dramatic nebula clouds */
  background:
    /* Milky Way diagonal band */
    linear-gradient(
      135deg,
      transparent 0%,
      transparent 30%,
      rgba(200, 210, 255, 0.08) 40%,
      rgba(180, 190, 255, 0.15) 50%,
      rgba(200, 210, 255, 0.08) 60%,
      transparent 70%,
      transparent 100%
    ),
    /* Main purple nebula (left side) */
    radial-gradient(
      ellipse 1200px 900px at 15% 35%,
      rgba(139, 92, 246, 0.25) 0%,
      rgba(167, 139, 250, 0.15) 30%,
      transparent 60%
    ),
    /* Blue-purple nebula (right side) */
    radial-gradient(
      ellipse 900px 1100px at 85% 65%,
      rgba(96, 165, 250, 0.18) 0%,
      rgba(139, 92, 246, 0.12) 35%,
      transparent 65%
    ),
    /* Pink accent nebula (center-right) */
    radial-gradient(
      ellipse 700px 500px at 70% 45%,
      rgba(232, 121, 249, 0.15) 0%,
      rgba(192, 132, 252, 0.08) 40%,
      transparent 70%
    ),
    /* Deep background glow */
    radial-gradient(
      ellipse 1400px 1000px at 50% 50%,
      rgba(79, 70, 229, 0.08) 0%,
      transparent 70%
    );

  filter: blur(80px);

  /* Dramatic drift animation with parallax */
  transform: translate(
    calc(var(--parallax-x) * 1.5),
    calc(var(--parallax-y) * 1.5)
  );
  /* Removed transition - JS lerp handles smoothness */
}

/* Animate nebula drift */
@keyframes nebula-drift {
  0%, 100% {
    background-position: 0% 0%, 100% 100%, 50% 50%;
  }
  33% {
    background-position: 10% 15%, 90% 85%, 45% 55%;
  }
  66% {
    background-position: -5% 10%, 105% 90%, 55% 45%;
  }
}

.starfield-nebula {
  animation: nebula-drift 120s ease-in-out infinite;
  background-size: 150% 150%, 130% 130%, 160% 160%;
}

/* ================================
   Layer 2 & 3: Particle Systems
   ================================ */

.starfield-particles {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* Stars layer - main starfield */
.starfield-particles--stars {
  z-index: 1;
  opacity: 0.9;
  filter: blur(0.3px);

  /* Medium parallax offset */
  transform: translate(
    calc(var(--parallax-x) * 0.6),
    calc(var(--parallax-y) * 0.6)
  );
  /* Removed transition - JS lerp handles smoothness */
}

/* Dust layer - slower, larger particles */
.starfield-particles--dust {
  z-index: 2;
  opacity: 0.6;
  filter: blur(1px);

  /* Stronger parallax for dust (closer to camera) */
  transform: translate(
    calc(var(--parallax-x) * 1.2),
    calc(var(--parallax-y) * 1.2)
  );
  /* Removed transition - JS lerp handles smoothness */
}

/* Static fallback for reduced motion */
.starfield-particles--static {
  filter: none !important;
  animation: none !important;
  transform: none !important;
}

/* ================================
   Layer 4: Shooting Stars
   ================================ */

.shooting-stars {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
  overflow: hidden;
}

.shooting-star {
  position: absolute;
  left: var(--start-x);
  top: var(--start-y);
  width: var(--length);
  height: 2px;

  /* Gradient trail effect */
  background: linear-gradient(
    to right,
    transparent 0%,
    rgba(255, 255, 255, var(--brightness)) 30%,
    rgba(167, 139, 250, var(--brightness)) 70%,
    transparent 100%
  );

  border-radius: 50%;
  filter: blur(1px);
  opacity: 0;
  transform: rotate(calc(-1 * var(--angle)));

  /* Animate across screen */
  animation: shooting-star var(--duration) ease-out forwards;
}

@keyframes shooting-star {
  0% {
    opacity: 0;
    transform: rotate(calc(-1 * var(--angle))) translateX(0);
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 0.8;
  }
  100% {
    opacity: 0;
    transform: rotate(calc(-1 * var(--angle))) translateX(200px);
  }
}

/* ================================
   Layer 5: Dystopian Signal Overlay
   ================================ */

.starfield-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 10;
}

/* Scanlines - horizontal CRT-style lines */
.starfield-overlay__scanlines {
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 2px,
    rgba(0, 0, 0, 0.015) 2px,
    rgba(0, 0, 0, 0.015) 4px
  );
  opacity: 0.4;
  pointer-events: none;
}

/* Vignette - darkened edges for cinematic feel */
.starfield-overlay__vignette {
  position: absolute;
  inset: 0;
  background: radial-gradient(
    ellipse at center,
    transparent 0%,
    transparent 40%,
    rgba(0, 0, 0, 0.12) 70%,
    rgba(0, 0, 0, 0.3) 100%
  );
  pointer-events: none;
}

/* Grain/noise overlay - subtle film grain effect */
.starfield-overlay__grain {
  position: absolute;
  inset: 0;
  opacity: 0.03;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  background-repeat: repeat;
  mix-blend-mode: overlay;
}

/* Animate grain for subtle movement */
@keyframes grain-drift {
  0%, 100% {
    transform: translate(0, 0);
  }
  25% {
    transform: translate(-0.5px, 0.5px);
  }
  50% {
    transform: translate(0.5px, -0.5px);
  }
  75% {
    transform: translate(-0.5px, -0.5px);
  }
}

.starfield-overlay__grain {
  animation: grain-drift 10s steps(4) infinite;
}

/* ================================
   Reduced Motion Support
   ================================ */

@media (prefers-reduced-motion: reduce) {
  .starfield-nebula {
    animation: none !important;
    transform: none !important;
    opacity: 0.15;
  }

  .starfield-overlay__grain {
    animation: none !important;
  }

  .starfield-particles {
    opacity: 0.3 !important;
    transform: none !important;
  }

  .shooting-stars {
    display: none;
  }
}

/* ================================
   Mobile Optimizations
   ================================ */

@media (max-width: 768px) {
  /* Lighter nebula on mobile */
  .starfield-nebula {
    opacity: 0.18;
    filter: blur(50px);
  }

  /* Lighter overlay effects */
  .starfield-overlay__scanlines {
    opacity: 0.25;
  }

  .starfield-overlay__grain {
    opacity: 0.02;
  }

  /* Reduced particle opacity */
  .starfield-particles--stars {
    opacity: 0.6;
  }

  .starfield-particles--dust {
    opacity: 0.3;
  }

  /* Lighter vignette */
  .starfield-overlay__vignette {
    background: radial-gradient(
      ellipse at center,
      transparent 0%,
      transparent 30%,
      rgba(0, 0, 0, 0.15) 80%,
      rgba(0, 0, 0, 0.35) 100%
    );
  }

  /* Disable parallax on mobile */
  .starfield-nebula,
  .starfield-particles--stars,
  .starfield-particles--dust {
    transform: none !important;
  }

  /* Fewer shooting stars on mobile */
  .shooting-star:nth-child(n+3) {
    display: none;
  }
}

/* ================================
   Dark Theme Support
   ================================ */

[data-theme="dark"] .starfield-container,
.dark .starfield-container {
  background: linear-gradient(180deg,
    #030308 0%,
    #080812 30%,
    #0a0a18 70%,
    #050510 100%
  );
}

[data-theme="dark"] .starfield-nebula,
.dark .starfield-nebula {
  opacity: 0.4;
}

[data-theme="dark"] .starfield-overlay__vignette,
.dark .starfield-overlay__vignette {
  background: radial-gradient(
    ellipse at center,
    transparent 0%,
    transparent 35%,
    rgba(0, 0, 0, 0.15) 70%,
    rgba(0, 0, 0, 0.35) 100%
  );
}
